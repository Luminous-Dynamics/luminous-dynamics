/**
 * Somatic Embodiment Layer - The Felt-Sense Bridge
 * 
 * This layer integrates the profound sensory universal-interconnectedness profiles from 
 * the original mystical glyphs with interactive embodiment experiences
 * that help practitioners literally FEEL the wisdom in their bodies.
 * 
 * The felt-sense is the bridge between practical technique and mystical
 * transmission - where understanding becomes embodied knowing.
 */

class SomaticEmbodimentLayer {
    constructor() {
        this.somaticProfiles = this.initializeSomaticProfiles();
        this.embodimentTools = this.initializeEmbodimentTools();
        this.progressiveTransmission = this.initializeProgressiveTransmission();
    }

    initializeSomaticProfiles() {
        return {
            "Ω0": {
                id: "Ω0",
                name: "First Presence",
                mysticalDesignation: "The Shimmering Unnamed",
                
                // Original Sensory Universal Interconnectedness & Empathic Universal Interconnectedness & Empathic Resonance Profile (from mystical layer)
                originalResonance: {
                    feelingTone: "Still, vast, potential, and un-authored. The feeling of a perfectly calm lake at dawn or the silence before the first note of a symphony.",
                    sonicQuality: "The sound of ambient, resonant silence itself. A sub-audible hum that is felt more than heard."
                },
                
                // Progressive Somatic Experience
                somaticLayers: {
                    accessible: {
                        bodyAwareness: "Feel your feet on the ground and your breath naturally flowing",
                        energeticQuality: "Settling, like dust particles slowly coming to rest in still air",
                        practiceInvitation: "Notice where your body wants to soften and let it",
                        feltSenseMarker: "You'll know you're present when rushing feelings dissolve into natural rhythm"
                    },
                    
                    developing: {
                        bodyAwareness: "Sense the spaciousness in your chest and the weight of your skeleton settling into gravity",
                        energeticQuality: "Like a bell that has finished ringing but the silence still holds the universal-interconnectedness",
                        practiceInvitation: "Find the place in your body that feels most 'home' and rest there",
                        feltSenseMarker: "Presence feels like returning to a place you never left"
                    },
                    
                    mystical: {
                        bodyAwareness: "Feel yourself as both form and formlessness - solid body arising from vast emptiness",
                        energeticQuality: "The feeling of dawn itself - potential on the verge of manifestation but not yet choosing a particular form",
                        practiceInvitation: "Rest in the 'hum of being here' before any action or thought takes shape",
                        feltSenseMarker: "The shimmer of pre-manifestation consciousness recognizing itself",
                        transmissionElements: {
                            breathPattern: "Like the tide at the perfect moment of stillness between waves",
                            heartRhythm: "The gentle throb of existence pulsing without urgency",
                            nervousSystemState: "Complete rest that is simultaneously completely alert"
                        }
                    }
                },
                
                // Interactive Somatic Tools
                embodimentExercises: {
                    accessible: [
                        {
                            name: "Gravity Anchor",
                            instruction: "Feel your weight settling into the earth for 30 seconds",
                            somaticFocus: "Lower body grounding and nervous system settling"
                        },
                        {
                            name: "Breath Space",
                            instruction: "Notice the pause between inhale and exhale - rest there",
                            somaticFocus: "Finding the natural stillpoint in breathing rhythm"
                        }
                    ],
                    
                    developing: [
                        {
                            name: "Presence Scan",
                            instruction: "Slowly scan your body for the place that feels most 'awake' without effort",
                            somaticFocus: "Locating natural presence in the body"
                        },
                        {
                            name: "Silence Listening",
                            instruction: "Listen to the quality of silence around you for 2 minutes",
                            somaticFocus: "Auditory presence and spatial awareness"
                        }
                    ],
                    
                    mystical: [
                        {
                            name: "The Shimmer Practice",
                            instruction: "Sense the aliveness that exists before thoughts form - the pre-verbal intelligence",
                            somaticFocus: "Consciousness recognizing itself before conceptualization"
                        },
                        {
                            name: "Dawn Embodiment",
                            instruction: "Feel yourself as the moment just before sunrise - full of potential, not yet manifested",
                            somaticFocus: "Embodying the feeling tone of pure potentiality"
                        }
                    ]
                },
                
                // Relational Somatic Dynamics
                relationalEmbodiment: {
                    withSelf: "Presence with your own inner experience without trying to change it",
                    withOther: "Creating a field of calm that others can feel and be influenced by",
                    withGroup: "Becoming an anchor point of stillness that helps the whole group settle",
                    withEnvironment: "Sensing yourself as part of the larger field of aliveness"
                },
                
                // Integration Bridges
                dailyLifeEmbodiment: {
                    microPractices: [
                        "One conscious breath at every red light",
                        "Feel your feet on the ground while waiting in line",
                        "Notice the pause between words when someone is speaking to you"
                    ],
                    situationalApplications: {
                        beforeMeetings: "30-second grounding to arrive fully present",
                        inConflict: "Find your center of gravity to respond rather than react",
                        whenOverwhelmed: "Return to the feeling of your breath in your body"
                    }
                }
            },

            "Ω1": {
                id: "Ω1", 
                name: "Conscious Arrival",
                mysticalDesignation: "The Sacred Threshold",
                
                originalResonance: {
                    feelingTone: "Intentional, purposeful, aligned. The feeling of a door opening to reveal sacred space.",
                    sonicQuality: "The sound of footsteps crossing from ordinary to sacred ground—deliberate, reverent, conscious."
                },
                
                somaticLayers: {
                    accessible: {
                        bodyAwareness: "Feel the transition in your body as you prepare to enter a new space or interaction",
                        energeticQuality: "Like adjusting your inner tuning fork to match the frequency of conscious participation",
                        practiceInvitation: "Notice how your body wants to show up here and honor that intelligence",
                        feltSenseMarker: "You'll feel a sense of intentional alignment rather than unconscious drifting"
                    },
                    
                    developing: {
                        bodyAwareness: "Sense the threshold moment - your body organizing itself around clear intention",
                        energeticQuality: "Like dawn breaking - the transition from one state of being to another",
                        practiceInvitation: "Feel how intention changes your posture, breathing, and presence",
                        feltSenseMarker: "Conscious arrival feels like coming home to your most authentic self"
                    },
                    
                    mystical: {
                        bodyAwareness: "Embody yourself as a sacred vessel crossing from one field of consciousness to another",
                        energeticQuality: "The feeling of crossing a threshold between dimensions - ordinary to sacred",
                        practiceInvitation: "Honor the liminal moment of transition as sacred passage",
                        feltSenseMarker: "Every threshold becomes a portal for conscious transformation",
                        transmissionElements: {
                            breathPattern: "Breath that honors both what you're leaving and what you're entering",
                            heartRhythm: "Heart opening to meet the moment with fresh presence",
                            nervousSystemState: "Alert readiness combined with relaxed confidence"
                        }
                    }
                },
                
                embodimentExercises: {
                    accessible: [
                        {
                            name: "Threshold Pause",
                            instruction: "Pause at doorways and feel your intention before entering",
                            somaticFocus: "Transition awareness and intentional body organization"
                        },
                        {
                            name: "Arrival Breath",
                            instruction: "Take one conscious breath that honors where you've been and where you're going",
                            somaticFocus: "Breath as bridge between states"
                        }
                    ],
                    
                    developing: [
                        {
                            name: "Quality Check-In",
                            instruction: "Ask your body: 'What quality wants to come through me here?' and listen",
                            somaticFocus: "Body wisdom and intentional presence"
                        },
                        {
                            name: "Conscious Posture",
                            instruction: "Let your body arrange itself to embody the intention you want to bring",
                            somaticFocus: "Posture as expression of consciousness"
                        }
                    ],
                    
                    mystical: [
                        {
                            name: "Sacred Crossing",
                            instruction: "Feel yourself as consciousness choosing its next expression - honor the power of that choice",
                            somaticFocus: "Embodying conscious choice and sacred intention"
                        },
                        {
                            name: "Portal Recognition",
                            instruction: "Sense every threshold as a doorway to transformation - let your body reverence the crossing",
                            somaticFocus: "Embodying reverence for liminal moments"
                        }
                    ]
                },
                
                relationalEmbodiment: {
                    withSelf: "Honoring your own transition and giving yourself time to arrive",
                    withOther: "Bringing your full presence as a gift to the interaction",
                    withGroup: "Setting the energetic tone through conscious arrival",
                    withEnvironment: "Honoring the space you're entering and how you want to meet it"
                },
                
                dailyLifeEmbodiment: {
                    microPractices: [
                        "One intentional breath before answering the phone",
                        "Pause at your front door to set intention for coming home",
                        "Feel your energy shift as you enter different rooms"
                    ],
                    situationalApplications: {
                        workTransitions: "Conscious arrival at desk/workspace each morning",
                        socialGatherings: "Intentional presence before joining group conversations", 
                        difficultConversations: "Arriving with clarity about how you want to show up"
                    }
                }
            },

            "Ω4": {
                id: "Ω4",
                name: "Sacred Listening", 
                mysticalDesignation: "The Resonant Heart",
                
                originalResonance: {
                    feelingTone: "Spacious, receptive, present. Like being held in a warm embrace of pure attention.",
                    sonicQuality: "The quality of deep silence that enhances rather than competes with sound—presence that amplifies truth."
                },
                
                somaticLayers: {
                    accessible: {
                        bodyAwareness: "Feel your heart space opening and your ears becoming soft and receptive",
                        energeticQuality: "Like being a loving container that can hold whatever wants to be shared",
                        practiceInvitation: "Let your whole body become curious about what the other person is really saying",
                        feltSenseMarker: "You'll feel a warm expansion in your chest and a natural slowing down"
                    },
                    
                    developing: {
                        bodyAwareness: "Sense yourself as a spacious field of attention that the speaker can rest into",
                        energeticQuality: "Like deep, still water that perfectly reflects whatever comes near",
                        practiceInvitation: "Feel how your quality of listening affects what becomes possible to say",
                        feltSenseMarker: "Sacred listening feels like love in action - both receiving and giving simultaneously"
                    },
                    
                    mystical: {
                        bodyAwareness: "Embody yourself as a sacred mirror reflecting the speaker's deepest truth back to them",
                        energeticQuality: "The feeling of being a resonant chamber that amplifies the wisdom trying to emerge",
                        practiceInvitation: "Become so present that your listening itself becomes a healing force",
                        feltSenseMarker: "The listener and speaker dissolve into a unified field of emerging truth",
                        transmissionElements: {
                            breathPattern: "Breath that creates space rather than takes up space",
                            heartRhythm: "Heart beating in attunement with the speaker's emotional rhythm",
                            nervousSystemState: "Relaxed alertness that can hold any emotional intensity"
                        }
                    }
                },
                
                embodimentExercises: {
                    accessible: [
                        {
                            name: "Heart-Centered Listening",
                            instruction: "Place attention in your heart while someone speaks and notice what shifts",
                            somaticFocus: "Heart-based attention and emotional receptivity"
                        },
                        {
                            name: "Spacious Ears",
                            instruction: "Soften your ears and jaw as if you're making room for their words to land",
                            somaticFocus: "Physical receptivity and nervous system settling"
                        }
                    ],
                    
                    developing: [
                        {
                            name: "Universal Interconnectedness & Empathic Universal Interconnectedness & Empathic Resonance Check",
                            instruction: "Notice what you feel in your body as they speak - let their emotions inform yours",
                            somaticFocus: "Empathetic universal-interconnectedness and emotional attunement"
                        },
                        {
                            name: "Silence Holding",
                            instruction: "Practice holding comfortable silence after they finish speaking",
                            somaticFocus: "Nervous system capacity for non-reactive presence"
                        }
                    ],
                    
                    mystical: [
                        {
                            name: "Mirror Practice",
                            instruction: "Feel yourself becoming a perfect reflection of their deepest truth - not their words, but their essence",
                            somaticFocus: "Embodying sacred witnessing and truth reflection"
                        },
                        {
                            name: "Field Listening",
                            instruction: "Listen not just to them but to what wants to emerge through the conversation",
                            somaticFocus: "Sensing the larger field of possibility and wisdom"
                        }
                    ]
                },
                
                relationalEmbodiment: {
                    withSelf: "Listening to your own inner experience with the same quality of presence",
                    withOther: "Creating safety for vulnerable truth through embodied presence",
                    withGroup: "Becoming an anchor of deep listening that influences the whole group",
                    withEnvironment: "Listening to the wisdom of spaces and sensing what they need"
                }
            }
        };
    }

    initializeEmbodimentTools() {
        return {
            // Real-time Somatic Feedback Tools
            feltSenseGuides: {
                heartRateVariabilityFeedback: "Visual breathing guide that matches your natural heart rhythm",
                bodyTensionScanner: "Progressive body awareness tool with gentle prompts",
                energeticStateIndicator: "Simple check-in to identify current nervous system state"
            },
            
            // Progressive Transmission Tools
            transmissionSequences: {
                beginnerEmbodiment: "Basic body awareness and breath connection",
                developingEmbodiment: "Emotional attunement and energetic sensitivity",
                mysticalEmbodiment: "Field awareness and consciousness recognition"
            },
            
            // Integration Support
            dailyEmbodimentBridges: {
                microMoments: "3-second somatic check-ins throughout the day",
                situationalEmbodiment: "Specific body-based practices for common scenarios",
                relationshipEmbodiment: "Partner practices for shared somatic awareness"
            }
        };
    }

    initializeProgressiveTransmission() {
        return {
            // How the felt-sense deepens with practice
            transmissionLevels: {
                recognition: "Beginning to notice the felt-sense dimension of practices",
                embodiment: "Practices becoming felt experiences rather than mental concepts",
                transmission: "Natural ability to share the felt-sense with others",
                integration: "Living from the embodied wisdom in daily life"
            },
            
            // Natural progression markers
            developmentMarkers: {
                somaticAwareness: "Increasing sensitivity to body wisdom and energy states",
                emotionalIntelligence: "Greater capacity to feel and work with emotional energy",
                fieldSensitivity: "Awareness of relational and environmental energy fields",
                consciousnessRecognition: "Direct felt-sense of awareness itself"
            }
        };
    }

    // Public API for Integration with Living Glyph Cards
    getSomaticProfile(glyphId, depthLevel = 'accessible') {
        const profile = this.somaticProfiles[glyphId];
        if (!profile) return null;
        
        return {
            originalResonance: profile.originalResonance,
            currentLayer: profile.somaticLayers[depthLevel],
            embodimentExercises: profile.embodimentExercises[depthLevel],
            relationalEmbodiment: profile.relationalEmbodiment,
            dailyLifeEmbodiment: profile.dailyLifeEmbodiment
        };
    }

    createEmbodimentExperience(glyphId, depthLevel, exerciseName) {
        const profile = this.getSomaticProfile(glyphId, depthLevel);
        if (!profile) return null;
        
        const exercise = profile.embodimentExercises.find(ex => ex.name === exerciseName);
        if (!exercise) return null;
        
        return {
            name: exercise.name,
            instruction: exercise.instruction,
            somaticFocus: exercise.somaticFocus,
            originalResonance: profile.originalResonance,
            feltSenseMarker: profile.currentLayer.feltSenseMarker,
            integrationSupport: profile.dailyLifeEmbodiment.microPractices
        };
    }

    // Integration Methods
    enhanceGlyphWithSomatics(glyphData) {
        const somaticProfile = this.getSomaticProfile(glyphData.id, glyphData.currentDepthLevel);
        if (!somaticProfile) return glyphData;
        
        return {
            ...glyphData,
            somaticEmbodiment: somaticProfile,
            enhancedInteractive: {
                ...glyphData.quadrants.how[glyphData.currentDepthLevel].interactiveComponent,
                somaticLayer: somaticProfile.currentLayer,
                embodimentExercises: somaticProfile.embodimentExercises
            }
        };
    }
}

// Export for global use
if (typeof window !== 'undefined') {
    window.SomaticEmbodimentLayer = SomaticEmbodimentLayer;
}

if (typeof module !== 'undefined' && module.exports) {
    module.exports = SomaticEmbodimentLayer;
}